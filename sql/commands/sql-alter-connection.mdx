---
title: "ALTER CONNECTION"
description: "The `ALTER CONNECTION` command modifies the definition of a connection. To use this command, you must own the connection."
---

## Syntax

```sql
ALTER CONNECTION connection_name
    alter_option;
```

_`alter_option`_ depends on the operation you want to perform on the connection. For all supported clauses, see the sections below.

## Clause

### `CONNECTOR WITH`

<Note>
Added in v2.6.0.
</Note>

```sql
ALTER CONNECTION connection_name
    CONNECTOR WITH ( property_name = value [, ...] );
```

This clause updates a connection's connector properties online and propagates the changes to all dependent sources and sinks that reference the connection.

| Parameter or clause | Description                                                                                                                               |
| :------------------ | :---------------------------------------------------------------------------------------------------------------------------------------- |
| **CONNECTOR WITH**  | Updates the connection's connector properties. Changes are applied atomically and propagated to all dependent sources and sinks. |
| _property\_name_    | The connector property to update. Use the same format as in [`CREATE CONNECTION`](/sql/commands/sql-create-connection).<br/><br/>Example: `properties.sasl.username = 'dev1'`<br/><br/>Secrets are supported: `properties.bootstrap.server = SECRET my_secret` |

#### Permissions

You must have privilege to alter the connection (same privilege checks as other `ALTER` operations on catalog objects).

#### Behavior

When you run `ALTER CONNECTION ... CONNECTOR WITH (...)`:

1. **Catalog update (atomic)**: The meta service updates the connection's stored properties and secret references, then finds all dependent sources and sinks and updates their stored connector options. These updates happen in one transaction.

2. **Validation**: The meta service validates that the altered keys are allowed to be changed online for that connector type, validates the updated connection, and validates each updated dependent source.

3. **Runtime propagation**: The meta service broadcasts a barrier mutation carrying the complete properties for each dependent object. Compute nodes rebuild their stream readers (sources) or sink configurations when they receive the mutation. Running jobs typically pick up the new configuration on the next barrier (usually within seconds).

#### Limitations

- Only a subset of connector fields can be altered online, depending on the connector type. Attempting to change disallowed keys will return an error.
- `ALTER CONNECTION ... CONNECTOR WITH (...)` does not allow referencing another connection inside the `WITH (...)` options (no nested connection references).

#### Example

This example shows how to rotate Kafka SASL credentials and brokers using secrets:

```sql
-- Create a secret for the bootstrap broker
CREATE SECRET s_broker WITH ( backend = 'meta' ) AS 'broker1.example.com:9092';

-- Create a Kafka connection using the secret
CREATE CONNECTION kafka_conn WITH (
  type = 'kafka',
  properties.bootstrap.server = SECRET s_broker,
  properties.security.protocol = 'SASL_PLAINTEXT',
  properties.sasl.mechanism = 'PLAIN',
  properties.sasl.username = 'user1',
  properties.sasl.password = 'password1'
);

-- Create a table using the connection
CREATE TABLE t_conn (x INT) WITH (
  connector = 'kafka',
  connection = kafka_conn,
  topic = 'test_topic'
) FORMAT PLAIN ENCODE JSON;

-- Rotate to a new broker and user
ALTER SECRET s_broker WITH ( backend = 'meta' ) AS 'broker2.example.com:9092';

-- Update the connection to use the new username
ALTER CONNECTION kafka_conn CONNECTOR WITH (
  properties.sasl.username = 'user2'
);
```

After running these commands, the table `t_conn` continues ingesting using the updated connection configuration without needing to be dropped and recreated.

### `SET SCHEMA`

```sql
ALTER CONNECTION connection_name
    SET SCHEMA schema_name;
```

| Parameter or clause | Description                                                                                                                               |
| :------------------ | :---------------------------------------------------------------------------------------------------------------------------------------- |
| **SET SCHEMA**      | This clause changes the schema of the connection. To change a connection's schema, you must also have CREATE privilege on the new schema. |
| _schema\_name_      | Specify the schema to which you want to change.                                                                                           |

```sql
-- Change the schema of the connection named "test_conn" to a schema named "test_schema"
ALTER CONNECTION test_conn SET SCHEMA test_schema;
```
